--- Modules/_posixsubprocess.c
+++ Modules/_posixsubprocess.c
@@ -670,7 +670,12 @@
         cwd_obj2 = NULL;
     }
 
+#ifdef HAVE_FORK
     pid = fork();
+#else
+    pid = -1;
+    errno = ENOTSUP;
+#endif
     if (pid == 0) {
         /* Child process */
         /*
